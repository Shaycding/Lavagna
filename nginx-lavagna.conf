upstream lavagna_backend {
    server lavagna:8080;
}

server {
    listen 80 default_server;
    server_name _;

    # Static files root - mapped from src/main/webapp
    root /var/www/lavagna/webapp;
    index index.html;

    # Serve favicon images directly from webapp/
    location /favicon/ {
        try_files $uri =404;
    }

    # Everything else goes to Lavagna backend
    location / {
        proxy_pass         http://lavagna_backend;
        proxy_set_header   Host              $http_host;
        proxy_set_header   X-Real-IP         $remote_addr;
        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
    }
}

# -----------------------------
# Documentation on port 8081
# -----------------------------
server {
    listen 8081;
    server_name _;

    root /var/www/lavagna/help;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }
}


